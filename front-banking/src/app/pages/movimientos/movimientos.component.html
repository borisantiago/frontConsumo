<h2>Buscar Movimientos</h2>

<form (ngSubmit)="buscarMovimientos()">
  <label>
    CÃ©dula:
    <select [(ngModel)]="filtros.identification" name="identification" required>
        <option value="" disabled selected>Seleccione una cÃ©dula</option>
        <option *ngFor="let cliente of clientes" [value]="cliente.identification">
          {{ cliente.identification }} - {{ cliente.name }}
        </option>
      </select>
  </label>

  <label>
    Desde:
    <input type="date" [(ngModel)]="filtros.start" name="start" required />
  </label>

  <label>
    Hasta:
    <input type="date" [(ngModel)]="filtros.end" name="end" required />
  </label>

  <button type="submit">Buscar</button>
</form>

<hr />

<h2>Movimientos de {{ cliente?.name }} ({{ cliente?.identification }}) </h2>

<table *ngIf="movimientos.length > 0; else sinMovimientos" style="border-collapse: collapse; width: 100%;">
    <thead>
      <tr style="border: 1px solid black;">
        <th style="border: 1px solid black;">NÂ° Cuenta</th>
        <th style="border: 1px solid black;">Tipo de Cuenta</th>
        <th style="border: 1px solid black;">Tipo Movimiento</th>
        <th style="border: 1px solid black;">Fecha</th>
        <th style="border: 1px solid black;">Monto</th>
        <th style="border: 1px solid black;">Balance</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let mov of movimientos" style="border: 1px solid black;">
        <td style="border: 1px solid black;">{{ mov.accountNumber }}</td>
        <td style="border: 1px solid black;">{{ mov.accountType }}</td>
        <td style="border: 1px solid black;">{{ mov.movementType }}</td>
        <td style="border: 1px solid black;">{{ mov.date }}</td>
        <td 
          style="border: 1px solid black; font-weight: bold;"
          [ngStyle]="{
            color: mov.movementType === 'CREDITO' ? 'green' : mov.movementType === 'DEBITO' ? 'red' : 'black'
          }">
          {{ mov.movementType === 'DEBITO' ? '-' : '' }}{{ mov.amount | currency:'USD' }}
        </td>
        <td style="border: 1px solid black;">{{ mov.balance | currency:'USD' }}</td>
      </tr>
    </tbody>
  </table>

<ng-template #sinMovimientos>
  <p>No se encontraron movimientos en el rango indicado.</p>
</ng-template>

<button (click)="generarPDF()">ðŸ“„ Exportar PDF</button>

